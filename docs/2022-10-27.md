# ç¯å¢ƒå˜é‡

> Vite åœ¨ä¸€ä¸ªç‰¹æ®Šçš„ import.meta.env å¯¹è±¡ä¸Šæš´éœ²ç¯å¢ƒå˜é‡ã€‚è¿™é‡Œæœ‰ä¸€äº›åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å¯ä»¥ä½¿ç”¨çš„å†…å»ºå˜é‡
>
> ```javascript
> interface ImportMetaEnv {
>   [key: string]: any
>   BASE_URL: string
>   MODE: string
>   DEV: boolean
>   PROD: boolean
>   SSR: boolean
> }
> ```

å®šä¹‰æ–¹å¼ä¹Ÿéå¸¸ç®€å•åœ¨é¡¹ç›®è·Ÿç›®å½•åˆ›å»ºæ–‡ä»¶ï¼Œæ–‡ä»¶å.env.{mode}(mode è‡ªè¡Œå®šä¹‰)ï¼Œè¿™æ ·åœ¨ package.json çš„ scripts å®šä¹‰ç›¸åº”çš„ mode æŒ‡ä»¤å°±å¯ä»¥äº†ï¼Œä¸¾ä¸ª ğŸŒ°

1. ç¬¬ä¸€æ­¥ï¼Œåˆ›å»ºæ–‡ä»¶
   <img src="../imgs/env_1.png" alt="env" title="env">
2. ç¬¬äºŒéƒ¨ï¼Œæ·»åŠ æŒ‡ä»¤

```javascript
"test-stage": "vite --mode staging"
```

3. ç¬¬ä¸‰æ­¥ï¼Œæ‰“å°è¾“å‡º
   <img src="../imgs/env_2.png" alt="env" title="env">

4. ç¬¬å››éƒ¨ï¼Œæ‰§è¡Œå‘½ä»¤

```javascript
pnpm run test-stage
```

5. ç¬¬äº”æ­¥ï¼Œæ‰“å°éªŒè¯
   <img src="../imgs/env_3.png" alt="env" title="env">

è¿™æ ·ä¸€ä¸ªè‡ªå®šä¹‰çš„ç¯å¢ƒå˜é‡å°±è®¾ç½®æˆåŠŸäº†ï¼Œæ’’èŠ± ğŸ‰ğŸ‰ğŸ‰

ä½†æ˜¯ã€‚ã€‚å¯ä½†æ˜¯ã€‚ã€‚å› ä¸ºæˆ‘ä»¬æ›´æ”¹äº† vite.config.ts ä¸­çš„é…ç½®å±æ€§ rootï¼Œè‡ªå®šä¹‰ç¯å¢ƒå˜é‡æ— æ³•æ­£ç¡®çš„å¼•å…¥åˆ° env ä¸­ ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­

é‚£æ¥ä¸‹æ¥å°±è§£å†³ä¸‹.env æ— æ³•ç”Ÿæ•ˆçš„é—®é¢˜

## æ–¹æ³•ä¸€

ç¬¬ä¸€æ­¥ï¼šå®‰è£…

```javascript
pnpm install dotenv -D
```

ç¬¬äºŒéƒ¨ï¼šä¿®æ”¹ vite.config.ts, æ‰‹åŠ¨å°†.env.{mode}é…ç½®è¿›å»

```javascript
import * as dotenv from 'dotenv';
...
dotenv.config({ path: `./.env.${mode}` });
```

## æ–¹æ³•äºŒ

å› ä¸ºæˆ‘ä»¬æ›´æ”¹äº† root="src/pages/", é‚£æˆ‘ä»¬å°±åœ¨ pages ä¸‹åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
<img src="../imgs/env_4.png" alt="env" title="env">

âš ï¸ æ¸©é¦¨æç¤ºï¼šåœ¨ä»£ç ä¸­æ·»åŠ  ts çš„æ™ºèƒ½æé†’ï¼Œä¿®æ”¹ vite-env.d.ts

```javascript
interface ImportMetaEnv {
  readonly NODE_ENV: string;
  readonly VITE_MY_KEY: string;
  readonly VITE_APP_TITLE: string;
}

interface ImportMeta {
  readonly env: ImportMetaEnv;
}
```
